# Plan: 035

Captured: 2025-09-12T16:26:59.238Z

## Fix TypeScript Validation Hook Issue

### Root Cause
The issue is a **TypeScript design limitation**: When you pass specific files to `tsc` (e.g., `tsc file.ts`), TypeScript **intentionally ignores** tsconfig.json and uses default compiler settings. This causes false errors because:
- Default module system doesn't support `import.meta` (needs ES2020+)
- Default target doesn't support Map iteration without flags
- Other modern features we use aren't enabled by default

TypeScript provides no native way to check a single file with project settings - this is confirmed by Stack Overflow discussions and open GitHub issues.

### Solution Options

**Option 1: Check entire project, filter output (Recommended)**
- Run `tsc --noEmit --incremental` on the whole project (0.3-0.5s with cache)
- Parse output to extract only errors for the edited file
- Benefits: Correct validation, reasonable performance, simple implementation
- The incremental flag creates a cache file that speeds up subsequent runs

**Option 2: Skip validation for certain files**
- Keep current approach but add a whitelist/blacklist
- Skip validation for files that are known to trigger false positives
- Not ideal but pragmatic

**Option 3: Accept the limitation**
- Document that the hook has known issues with certain TypeScript features
- Users can disable the hook if it causes problems
- Simplest but not satisfying

### Recommendation
Implement Option 1. The performance impact is minimal (0.3-0.5s) and it ensures correct validation. We'll update the edit-validation hook to run TypeScript on the full project and filter the output.