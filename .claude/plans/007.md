# Plan: 007

Captured: 2025-09-10T11:14:53.120Z

## Plan: Add Configuration System to cc-pars

### Overview
Create a configuration system that allows users to enable/disable individual hooks and customize cc-pars behavior through a config file and slash command.

### Components to Create

#### 1. Configuration File: `.claude/cc-pars.config.json`
```json
{
  "hooks": {
    "capture_plan": {
      "enabled": true,
      "description": "Captures plans from ExitPlanMode and creates task files"
    },
    "pre_compact": {
      "enabled": true,
      "description": "Extracts error patterns before compaction"
    },
    "post_compact": {
      "enabled": true,
      "description": "Restores context after compaction"
    },
    "stop_review": {
      "enabled": true,
      "description": "Reviews changes and auto-commits with [wip]"
    }
  },
  "features": {
    "statusline": {
      "enabled": true,
      "description": "Custom status line showing costs and task info"
    }
  }
}
```

#### 2. Configuration Helper Module: `.claude/lib/config.ts`
- Function to read config with defaults
- Function to check if a hook is enabled
- Function to update config values

#### 3. Update Each Hook
Add early exit check at the beginning of each hook:
- `.claude/hooks/capture_plan.ts`
- `hooks/pre_compact.ts`
- `hooks/post_compact.ts`
- `hooks/stop_review.ts`

Each hook will:
1. Import the config helper
2. Check if it's enabled
3. Exit silently if disabled

#### 4. Slash Command: `.claude/commands/config-cc-pars.md`
Command that:
- Shows current configuration when run without parameters
- Accepts natural language parameters like:
  - `/config-cc-pars disable task creation`
  - `/config-cc-pars enable stop review`
  - `/config-cc-pars show`
- Provides interactive menu if no parameter given

### Implementation Details

#### Config Helper (`lib/config.ts`)
```typescript
interface Config {
  hooks: {
    [key: string]: {
      enabled: boolean;
      description: string;
    };
  };
  features: {
    [key: string]: {
      enabled: boolean;
      description: string;
    };
  };
}

export function getConfig(): Config
export function isHookEnabled(hookName: string): boolean
export function updateConfig(path: string, value: any): void
```

#### Hook Modification Pattern
```typescript
// At the top of each hook
import { isHookEnabled } from '../lib/config';

async function main() {
  // Check if hook is enabled
  if (!isHookEnabled('hook_name')) {
    // Silent exit
    console.log(JSON.stringify({ continue: true }));
    process.exit(0);
  }
  
  // Rest of hook logic...
}
```

#### Command Structure
The command will:
1. Parse user input for keywords
2. Map keywords to config paths
3. Update the config file
4. Show confirmation

### File Changes Summary
1. **Create**: `.claude/cc-pars.config.json` - Configuration file
2. **Create**: `.claude/lib/config.ts` - Config helper module
3. **Create**: `.claude/commands/config-cc-pars.md` - Slash command
4. **Update**: `.claude/hooks/capture_plan.ts` - Add config check
5. **Update**: `hooks/pre_compact.ts` - Add config check
6. **Update**: `hooks/post_compact.ts` - Add config check
7. **Update**: `hooks/stop_review.ts` - Add config check

### Benefits
- Users can disable hooks they don't want
- Easy to configure via slash command
- Hooks exit cleanly when disabled (no errors)
- Extensible for future features
- Clear documentation of what each hook does