# Plan: 027

Captured: 2025-09-11T19:57:59.184Z

# Plan: Add Semantic Release with Automatic GitHub Release Publishing

## Overview
Implement semantic-release with GitHub Actions to automatically:
- Determine version numbers based on conventional commits
- Generate changelogs 
- Create GitHub releases
- Build and upload cross-platform executables (Linux & Windows)

## Key Components

### 1. Semantic Release Configuration
- **Install Dependencies**: Add `semantic-release`, `@semantic-release/github`, `@semantic-release/exec` to devDependencies
- **Create .releaserc.json**: Configure plugins for commit analysis, changelog generation, execution hooks, and GitHub integration
- **Commit Convention**: Use conventional commits (feat/fix/BREAKING CHANGE) for automated version bumping

### 2. GitHub Actions Workflow
- **Trigger**: On push to master branch
- **Build Matrix**: Cross-compile binaries for `bun-linux-x64` and `bun-windows-x64`
- **Integration**: Use semantic-release to coordinate versioning and release creation
- **Asset Upload**: Attach compiled binaries to GitHub releases automatically

### 3. Cross-Platform Build Scripts
- **Update package.json**: Add scripts for cross-platform compilation
- **Build Commands**: 
  - `bun build --compile src/cli/index.ts --target=bun-linux-x64 --outfile dist/cc-track-linux`
  - `bun build --compile src/cli/index.ts --target=bun-windows-x64 --outfile dist/cc-track-windows.exe`

### 4. Configuration Updates
- **Update .gitignore**: Ensure dist/ remains ignored for local builds but allow CI builds
- **Package.json**: Add release scripts and semantic-release config
- **GitHub Permissions**: Ensure workflow has permissions to create releases and upload assets

## Implementation Steps

### Phase 1: Setup Dependencies
1. Add semantic-release packages to devDependencies
2. Create `.releaserc.json` configuration file
3. Add cross-platform build scripts to package.json

### Phase 2: GitHub Actions Workflow
1. Create `.github/workflows/release.yml`
2. Configure build matrix for Linux/Windows
3. Set up semantic-release execution with asset uploads

### Phase 3: Commit Message Format Migration
1. **Update GitHelpers.generateCommitMessage()**: Modify Claude CLI prompts to always return conventional commit format (feat:, fix:, chore:, docs:, etc.)
2. **Update complete-task command**: Ensure task completion commits use format like `feat: complete TASK_XXX - [description]` or `chore: complete TASK_XXX - [description]`
3. **Update stop-review hook**: Modify auto-commit messages to use conventional format like `chore: save work in progress` or `wip: [description]`
4. **Update system prompts**: Any place where Claude generates commit messages should follow conventional commit convention
5. **Add commit validation**: Consider adding commitlint or husky to enforce conventional commit format

### Phase 4: Testing & Validation
1. Test workflow with feature commits (minor version bump)
2. Test with fix commits (patch version bump)  
3. Test with BREAKING CHANGE commits (major version bump)
4. Validate binary uploads and release notes generation
5. Verify all auto-generated commits follow conventional format

## Benefits
- **Automated Versioning**: No manual version management needed
- **Consistent Releases**: Standardized process with changelogs
- **Cross-Platform Distribution**: Automatic Linux/Windows binary builds
- **GitHub Integration**: Releases with attached executables ready for download
- **Proper Version Semantics**: All commits (manual and automated) contribute correctly to versioning

## Migration Considerations
- Current version is 1.0.0 in package.json - semantic-release will take over from next release
- Existing manual release process can be phased out
- All existing commit message generation points will be updated to use conventional format
- Future commits will automatically trigger appropriate version bumps and releases