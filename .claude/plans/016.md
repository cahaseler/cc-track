# Plan: 016

Captured: 2025-09-10T16:09:31.734Z

# Set Up TypeScript and Linting for cc-pars

## Current State Analysis

### Project Setup
- **Runtime**: Bun 1.2.8 (has built-in TypeScript support)
- **Package Manager**: Bun
- **TypeScript Files**: 11 .ts files across hooks, scripts, and lib directories
- **Current Issues**:
  - No tsconfig.json (relying on Bun's defaults)
  - No linting configuration
  - 12 uses of `any` type across codebase
  - No type checking scripts
  - TypeScript package not installed

## Proposed Solution

### 1. Install TypeScript and Tooling
```bash
bun add -d typescript @biomejs/biome
```
- **TypeScript**: For explicit type checking with `tsc`
- **Biome**: Modern, fast linter/formatter (Bun-friendly, replaces ESLint + Prettier)

### 2. Create tsconfig.json
Strict TypeScript configuration for maximum type safety:
```json
{
  "compilerOptions": {
    "target": "ES2022",
    "module": "ES2022",
    "lib": ["ES2022"],
    "moduleResolution": "bundler",
    "strict": true,
    "noImplicitAny": true,
    "strictNullChecks": true,
    "strictFunctionTypes": true,
    "strictBindCallApply": true,
    "strictPropertyInitialization": true,
    "noImplicitThis": true,
    "alwaysStrict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "noImplicitReturns": true,
    "noFallthroughCasesInSwitch": true,
    "skipLibCheck": true,
    "esModuleInterop": true,
    "allowSyntheticDefaultImports": true,
    "forceConsistentCasingInFileNames": true,
    "types": ["bun-types", "node"]
  },
  "include": [
    ".claude/**/*.ts",
    "scripts/**/*.ts"
  ],
  "exclude": ["node_modules"]
}
```

### 3. Create biome.json
Sensible linting and formatting rules:
```json
{
  "$schema": "https://biomejs.dev/schemas/1.9.4/schema.json",
  "organizeImports": {
    "enabled": true
  },
  "linter": {
    "enabled": true,
    "rules": {
      "recommended": true,
      "complexity": {
        "noBannedTypes": "error",
        "noUselessTypeConstraint": "error"
      },
      "correctness": {
        "noUnusedVariables": "warn",
        "useExhaustiveDependencies": "off"
      },
      "suspicious": {
        "noExplicitAny": "error",
        "noImplicitAnyLet": "error"
      },
      "style": {
        "noNonNullAssertion": "warn",
        "useConst": "error",
        "useTemplate": "error"
      }
    }
  },
  "formatter": {
    "enabled": true,
    "indentStyle": "space",
    "indentWidth": 2,
    "lineWidth": 120
  }
}
```

### 4. Fix Type Issues
Replace `any` types with proper types:
- `logger: any` → Create proper Logger interface
- `content: any` → Define specific content types
- `[key: string]: any` → Use specific object shapes
- `catch (error: any)` → Use `unknown` and type guards

### 5. Add Scripts to package.json
```json
{
  "scripts": {
    "init": "bun run scripts/init-templates.ts",
    "typecheck": "tsc --noEmit",
    "lint": "biome check .",
    "format": "biome format --write .",
    "fix": "biome check --write .",
    "check": "bun run typecheck && bun run lint"
  }
}
```

### 6. Create Pre-Push Hook
Add to `.claude/backlog.md` suggestion about git hooks:
- Pre-push hook runs `bun run check`
- Ensures code quality before pushing

## Benefits

1. **Type Safety**: Catch errors at development time
2. **Better IDE Support**: Auto-completion and refactoring
3. **Code Quality**: Consistent formatting and style
4. **Maintainability**: Self-documenting code through types
5. **Bun-Optimized**: Uses tools that work well with Bun

## Implementation Order

1. Install dependencies
2. Create tsconfig.json
3. Create biome.json  
4. Fix existing type issues (12 `any` usages)
5. Update package.json scripts
6. Test the setup with `bun run check`
7. Document in README or CONTRIBUTING.md

## Testing Plan

After setup:
1. Run `bun run typecheck` - should show current type errors
2. Run `bun run lint` - should show linting issues
3. Fix issues incrementally
4. Verify all hooks still work
5. Commit with message about adding TypeScript/linting