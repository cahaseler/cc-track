# Plan: 071

Captured: 2025-09-17T14:29:24.338Z

## Plan: Add Hook Status Display to Statusline

**Goal:** Display recent stop-review hook messages in the statusline as a workaround for Claude Code hiding hook outputs.

**Changes:**

1. **Modify Stop-Review Hook** (`src/hooks/stop-review.ts`):
   - Write hook status to `.claude/hook-status.json` with timestamp and message
   - Format: `{"timestamp": "2025-09-17T10:30:00.000Z", "message": "Project is on track", "source": "stop_review"}`
   - Only write when there's a meaningful status (not "No changes to commit")

2. **Update Statusline Script** (`.claude/statusline.sh`):
   - Add logic to read `.claude/hook-status.json`
   - Check if message is less than 60 seconds old
   - If recent message exists, add it as a third line above the current two lines
   - Use basic message text only (not details)
   - Format: `üõ§Ô∏è [message]` to match existing hook emoji

3. **Statusline Structure** (3 lines when hook message present):
   ```
   üõ§Ô∏è Project is on track                           <- NEW: Hook status line
   üöÖ Sonnet ü™ô $0.45 (2.1k tokens) ‚è±Ô∏è 1m 23s          <- Current line 1  
   üõ§Ô∏è main | TASK_XXX: Task description             <- Current line 2
   ```

**Testing:**
- Trigger stop-review hook by making changes and stopping
- Verify message appears in statusline within 1-2 message exchanges
- Verify message disappears after 1 minute
- Test with different stop-review statuses (on track, deviation, etc.)

This provides immediate user-visible feedback for the most important hook (stop-review) while we wait for Anthropic to fix the broader hook visibility issue.